<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <title>图书管理系统</title>
    <link href="https://cdn.bootcss.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>
    <style>
        body{
            background-image: url(ima/bg1.jpg);
            background-size: 100%;
        }
        #list{
            background-color: rgba(255,255,255,1);
            margin-top: 50px;
        }
        td{
            width: 200px;
        }
        #di{
            width: 100%;
            height: 100px;
            background-color: rgba(45,45,45,0.8);
            margin-top: 300px;
            padding-top: 10px;
            border-radius: 10px 10px 0px 0px;
        }
        .p1{
            color: white;
            text-align: center;
            margin-top: 15px;
        }
        #div1,#div2{
            display:inline-block;
            width: 30%;
        }
        #ctr{
            background-color: rgba(45,45,45,0.8);
            padding: 20px;
            border-radius: 10px;
        }
        h4{
            display: inline-block;
            color: white;
        }
        #p6{
            display: inline-block;
            text-align: center;
            margin-left: 380px;
        }
        #btn1{
            display: inline-block;
            background-color: #1C86EE;
            width: 100px;
            border: 0px;
            color: white;
        }
        .col-lg-4{
            padding-bottom: 10px;
        }
        #btn2{
            background-color: #EE3B3B;
            border: 0px;
            display:none;
        }
        tr:hover #btn2{
           display: block;
        }
        #p1,#p2,#p3,#p4,#p5,#p6{
            color:#FF6A6A;
        }
        #find{
            margin-bottom: 15px;
        }
        #find a{
            display:inline-block;

        }
    </style>
</head>
<body>
    <div class="container">
<!-- 导航栏 -->
    <nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">图书管理系统</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="read.html">浏览 <span class="sr-only">(current)</span></a></li>
        <li class="active"><a href="add.html">管理</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="library.html">登录</a></li>
        <li><a href="signup.html">注册</a></li>
        <li><a href="shi.html">联系我们</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<div id="ctr">
<!-- 搜索 -->
    <div id="find" class="input-group">
          <span class="input-group-addon" id="sizing-addon1"><a type="button" onclick="findbook()"><span class=" glyphicon glyphicon-search"></span></a></span>
          <input id="findinp" type="text" class="form-control" placeholder="搜索" aria-describedby="sizing-addon1">
    </div>
<!-- 添加书籍信息 -->
<h4>添加书籍信息</h4><p id="p6" class="center-block"></p>
<button id="btn1" type="button" class="btn btn-default navbar-right">添加</button>
<div class="row">
    <div class="col-lg-4">
        <div class="input-group">
          <span class="input-group-addon" id="sizing-addon1">书名</span>
          <input id="inp1" type="text" class="form-control" placeholder="书名" aria-describedby="sizing-addon1" onblur="input1()">
        </div>
        <p id="p1"></p>
    </div>
    <div class="col-lg-4">
        <div class="input-group">
          <span class="input-group-addon" id="sizing-addon1">作者</span>
          <input id="inp2" type="text" class="form-control" placeholder="作者" aria-describedby="sizing-addon1" onblur="input2()">
        </div>
        <p id="p2"></p>
    </div>
    <div class="col-lg-4">
        <div class="input-group">
          <span class="input-group-addon" id="sizing-addon1">出版社</span>
          <input id="inp3" type="text" class="form-control" placeholder="出版社" aria-describedby="sizing-addon1" onblur="input3()">
        </div>
        <p id="p3"></p>
    </div>
</div>
<div class="row" id="row2">
    <div class="col-lg-4">
        <div class="input-group">
          <span class="input-group-addon" id="sizing-addon1">数量</span>
          <input id="inp4" type="text" class="form-control" placeholder="数量" aria-describedby="sizing-addon1" onblur="input4()">
        </div>
        <p id="p4"></p>
    </div>
    <div class="col-lg-4">
        <div class="input-group">
          <span class="input-group-addon" id="sizing-addon1">单价</span>
          <input id="inp5" type="text" class="form-control" placeholder="单价" aria-describedby="sizing-addon1" onblur="input5()">
        </div>
        <p id="p5"></p>
    </div>
</div>
</div>
<!-- 图书列表 -->
   <div id="list">
       <table id="table" class="table table-hover">
        <thead>
			<tr>
				<th>书名</th>
				<th>作者</th>
				<th>出版社</th>
				<th>数量</th>
				<th>单价</th>
			</tr>
			</thead>
       </table>
   </div>
<!--底部信息-->
   <div id="di">
       <p class="p1">图书管理系统</p>
       <p class="p1">Copyright © 2017-2018 15150400413 杨溢超</p>
   </div>
    </div>
<script type="text/javascript">
//校验输入的信息
   var ok1;
    var ok2;
    var ok3;
    var ok4;
    var ok5;
    function input1(){
    var inp1=document.getElementById("inp1").value;
    var txt1=document.getElementById("p1");
        if(1<inp1.length<12){
            ok1=true;
        }
        if(!inp1){
            txt1.innerHTML="请输入书名";
        }else{
            txt1.innerHTML="";
            if(inp1.length>12||inp1.length<1){
                txt1.innerHTML="请输入1-12位字符";
            }
        }
    }
    function input2(){
    var inp2=document.getElementById("inp2").value;
    var txt2=document.getElementById("p2");
        if(1<inp2.length<12){
            ok2=true;
        }
        if(!inp2){
            txt2.innerHTML="请输入作者";
        }else{
            txt2.innerHTML="";
            if(inp2.length>12||inp2.length<1){
                txt2.innerHTML="请输入1-12位字符";
            }
        }
    }
    function input3(){
    var inp3=document.getElementById("inp3").value;
    var txt3=document.getElementById("p3");
        if(1<inp3.length<12){
            ok3=true;
        }
        if(!inp3){
            txt3.innerHTML="请输入出版社";
        }else{
            txt3.innerHTML="";
            if(inp3.length>12||inp3.length<1){
                txt3.innerHTML="请输入1-12位字符";
            }
        }
    }
    function input4(){
    var inp4=document.getElementById("inp4").value;
    var txt4=document.getElementById("p4");
        if(1<inp4.length<12){
            ok4=true;
        }
        if(!inp4){
            txt4.innerHTML="请输入数量";
        }else{
            txt4.innerHTML="";
            if(inp4.length>12||inp4.length<1){
                txt4.innerHTML="请输入1-12位整数";
            }
            var re=/^\d+$/;
            if(!re.test(inp4)){
                txt4.innerHTML="请输入整数";
            }
        }
    }
    function input5(){
    var inp5=document.getElementById("inp5").value;
    var txt5=document.getElementById("p5");
        if(1<inp5.length<12){
            ok5=true;
        }
        if(!inp5){
            txt5.innerHTML="请输入单价";
        }else{
            txt5.innerHTML="";
            if(inp5.length>12||inp5.length<1){
                txt5.innerHTML="请输入1-12位数字";
            }
            var re=/^[0-9]+(.[0-9]{2})?$/;
            if(!re.test(inp5)){
                txt5.innerHTML="请输入两位小数数字";
            }
        }
    }
//添加按钮校验
    $("#btn1").click(function(){
        if(ok1&&ok2&&ok3&&ok4&&ok5){
            zhuan();
        }else{
            $("#p6").text("添加失败，请检查录入信息！");
        }
    });
//创建信息data数组
      var data=[{"book":"《解忧杂货店》","author":"东野圭吾","pub":"南海出版社","num":35,"price":"￥27.30<button id='btn2'  onclick='del(this)' class='btn btn-primary navbar-right btn-xs'>删除</button>"},
           {"book":"《芳华》","author":"严歌苓","pub":"人民文学出版社","num":127,"price":"￥31<button onclick='del(this)' id='btn2' class='btn btn-primary navbar-right btn-xs'>删除</button>"},
           {"book":"《我们仨》","author":"杨绛","pub":"人民文学出版社","num":54,"price":"￥15.90<button id='btn2' onclick='del(this)' class='btn btn-primary navbar-right btn-xs'>删除</button>"},
           {"book":"《原则》","author":"瑞·达利欧","pub":"中信出版社","num":256,"price":"￥66<button id='btn2' onclick='del(this)' class='btn btn-primary navbar-right btn-xs'>删除</button>"},
           {"book":"《白夜行》","author":"东野圭吾","pub":"南海出版社","num":155,"price":"￥41.10<button id='btn2' onclick='del(this)' class='btn btn-primary navbar-right btn-xs'>删除</button>"},
           {"book":"《我与地坛》","author":"史铁生","pub":"人民文学出版社","num":94,"price":"￥19.60<button onclick='del(this)' id='btn2' class='btn btn-primary navbar-right btn-xs'>删除</button>"}];
//把json数据加载到页面
    window.onload=function(){

        var table=document.getElementById("table");
        for(var i=0;i<data.length;i++){
            var row=table.insertRow(table.rows.length);
            var c1=row.insertCell(0);
            c1.innerHTML=data[i].book;
            var c2=row.insertCell(1);
            c2.innerHTML=data[i].author;
            var c3=row.insertCell(2);
            c3.innerHTML=data[i].pub;
            var c4=row.insertCell(3);
            c4.innerHTML=data[i].num;
            var c5=row.insertCell(4);
            c5.innerHTML=data[i].price;
        }
    }
//把输入框内容转换为json格式
    function zhuan(){
      parArr = {};
       var book = $('#inp1').val().replace(/(^\s*)|(\s*$)/g, "");
       parArr.book = book;
       var author = $('#inp2').val().replace(/(^\s*)|(\s*$)/g, "");
       parArr.author = author;
       var pub = $('#inp3').val().replace(/(^\s*)|(\s*$)/g, "");
       parArr.pub = pub;
       var num = $('#inp4').val().replace(/(^\s*)|(\s*$)/g, "");
       parArr.num = num;
       var price = $('#inp5').val().replace(/(^\s*)|(\s*$)/g, "")+"<button id='btn2' onclick='del(this)' class='btn btn-primary navbar-right btn-xs'>删除</button>";
       parArr.price = price;
       var params = JSON.stringify(parArr);
       var str1 = JSON.parse(params); 
//存入数组
       data.push(str1);
//遍历数组最后一个元素添加行
        function add(){
        var table=document.getElementById("table");
        for(var i=data.length-1;i<data.length;i++){
            var row=table.insertRow(table.rows.length);
            var c1=row.insertCell(0);
            c1.innerHTML=data[i].book;
            var c2=row.insertCell(1);
            c2.innerHTML=data[i].author;
            var c3=row.insertCell(2);
            c3.innerHTML=data[i].pub;
            var c4=row.insertCell(3);
            c4.innerHTML=data[i].num;
            var c5=row.insertCell(4);
            c5.innerHTML=data[i].price;
        }
        }
        add();
    }
//删除按钮
    function del(data){
	$(data).parent().parent().remove(); 
    }  
//搜索功能
    function findbook(){
        console.log("21");
        var input=document.getElementById("findinp");
        var filter=input.value.toUpperCase();
        var table=document.getElementById("table");
        var tr=table.getElementsByTagName("tr");
        for(var i=0;i<tr.length;i++){
           var td =tr[i].getElementsByTagName("td")[0];
            var td1 =tr[i].getElementsByTagName("td")[1];
            var td2 =tr[i].getElementsByTagName("td")[2];
          console.log(td);
        if (td) {
          if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {         
              if (td1.innerHTML.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
              }else{
                  if (td2.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                  }else{
                      tr[i].style.display = "none";
                  }
              }
          }
        }    
        }
    }
</script>
</body>
</html>